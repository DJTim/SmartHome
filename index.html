<!DOCTYPE html>
<html>
<head>
	<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
  	<script type="text/javascript">
  	
  	function updateGUI(data){
  		$.each(data['lights'], function( index, value ) {
				if(value['type']=='switch'){
					if (value['state']=='off'){
						$("#btnBack_"+value['name']).css( "background-color", "#797979" );
						$("#btnBack_"+value['name']).attr("onclick","domo_switch('"+value['name']+"','on')");
						$("#btn_"+value['name']).html("ON");
					}else{
						$("#btnBack_"+value['name']).css( "background-color", "#454545" );
						$("#btnBack_"+value['name']).attr("onclick","domo_switch('"+value['name']+"','off')");
						$("#btn_"+value['name']).html("OFF");
					}
				}
			});
	}
	
	function domo_switch(id, state){
		$.ajax({
		  type: "PUT",
		  url: "http://192.168.2.215:8080/api/Tim/"+id,
		  data: '{"state": "'+state+'"}',
		  dataType: "json"
		});
	}
	
	function updateGUIPoll() {
        var poll_interval=0;

        $.ajax({
                url: "http://192.168.2.215:8080/api/rooms/listen",
                type: 'GET',
                dataType: 'json',
                success: function(data) {
                        updateGUI(data);
                        poll_interval=0;
                },
                error: function () {
                        poll_interval=1000;
                },
                complete: function () {
                        setTimeout(updateGUIPoll, poll_interval);
                },
        });
	}
	
	$(function() {
		//initial update of GUI
		$.get( "http://192.168.2.215:8080/api/rooms/Tim", updateGUI);
		
		//start long polling to server
		updateGUIPoll();
	})
	</script>
<style>
* {
   margin: 0px;
   padding: 0px;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    cursor: none; 
}
body {
    overflow:hidden;
}
.page{
	font-family: "Helvetica Neue";
	font-weight: lighter;
	color: #bebebe;
}
.row{
	width: 320px;
}
.cellHeadLeft{
	width: 160px;
	height: 70px;
	background-color: #000;
	float: left;
	font-size: 60px;
}
.cellHeadRight{
	width: 160px;
	height: 70px;
	background-color: #454545;
	float: right;
	font-size: 21px;
}
.alignMiddle{
	margin-top: 10px;
	margin-left: 5px;
	margin-bottom: 10px;
}
.cellLeft{
	width: 160px;
	height: 170px;
	/*background-color: #797979;*/
	float: left;
	text-align: center;
	font-size: 30px;
}
.cellRight{
	width: 160px;
	height: 170px;
	/*background-color: #797979;*/
	float: right;
	text-align: center;
	font-size: 30px;
}
.alignCenter{
	margin-top: 70px;
}
</style>
</head>
<body>
<div class="page">
	<div class="row">
		<div class="cellHeadLeft">
		15:00
		</div>
		<div class="cellHeadRight">
			<div class="alignMiddle">
				Friday <br>
				December 26
			</div>
		</div>
	</div>
	<div class="row">
		<div id="btnBack_lightLeft" class="cellLeft">
			<div id="btn_lightLeft" class="alignCenter">
				ON
			</div>
		</div>
		<div id="btnBack_lightRight" class="cellRight">
			<div id="btn_lightRight" class="alignCenter">
				ON
			</div>
		</div>
	</div>
</div>

</body>
</html>